<!DOCTYPE html>
<html lang="en">

<head>
    {{ template "head.html" . }}
</head>

<body class="min-h-screen bg-gray-50 p-4" data-page="graph">
    {{ template "nav.html" . }}

    <main class="w-full max-w-screen-lg mx-auto space-y-6 bg-white shadow rounded-xl p-6">
        <h1 class="text-2xl font-semibold text-center">Graph builder</h1>
        <p class="text-gray-600 text-center text-sm">
            Create ad hoc diagrams for selected entities.
            Shift-click an entity in the graph to search for its related entities.
        </p>

        <!-- Selected Entities -->
        {{ if .SelectedEntities }}
        <div id="selected-entities" class="flex flex-wrap gap-2">
            {{ range .SelectedEntities }}
            <div class="flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm">
                <span>{{ .GetQName }}</span>
                <button onclick="removeEntityFromGraph('{{ .GetRef }}')"
                    class="hover:text-blue-900 font-bold ml-1">&times;</button>
            </div>
            {{ end }}
        </div>
        {{ end }}

        <!-- Search -->
        {{ template "search_bar.html" . }}

        <!-- Table -->
        <div class="overflow-x-auto border rounded-xl max-h-60 overflow-y-auto">
            <table class="min-w-full table-auto border-collapse">
                <thead class="bg-gray-100">
                    <tr>
                        <th class="px-4 py-2 text-left">Name</th>
                        <th class="px-4 py-2 text-left">Kind</th>
                        <th class="px-4 py-2 text-left">System</th>
                        <th class="px-4 py-2 text-right"><!--Action--></th>
                    </tr>
                </thead>
                <tbody id="{{ .EntitiesLabel }}-tbody">
                    {{ template "graph_rows.html" . }}
                </tbody>
            </table>
        </div>

        {{ if .SVG }}
        <div id="relationships-svg">
            {{ .SVG }}
        </div>
        <script type="application/json" id="relationships-svg-meta">
            {{ .SVGMetadataJSON }}
        </script>
        {{ end }}
    </main>

    {{ template "footer.html" . }}

    <script type="module" src="/static/dist/main.js?v={{.CacheBustingKey}}"></script>
</body>

</html>